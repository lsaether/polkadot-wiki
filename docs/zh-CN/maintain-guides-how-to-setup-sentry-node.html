<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>设置哨兵节点 · Polkadot Wiki</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="本教程假设你已经设置好验证人并且想把你的节点提高女巫攻击或 DDOs 防御保护。这个跟 [polkadot secure validator](https://github.com/w3f/polkadot-secure-validator) 配置一样。"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="设置哨兵节点 · Polkadot Wiki"/><meta property="og:type" content="website"/><meta property="og:url" content="https://lsaether.github.io/polkadot-wiki/index.html"/><meta property="og:description" content="本教程假设你已经设置好验证人并且想把你的节点提高女巫攻击或 DDOs 防御保护。这个跟 [polkadot secure validator](https://github.com/w3f/polkadot-secure-validator) 配置一样。"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/polkadot-wiki/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli&amp;display=swap"/><link rel="stylesheet" href="/css/klaro.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://wiki.polkadot.network/js/load.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script><script type="text/javascript" src="/js/custom.js"></script><script type="text/javascript" src="/js/klaro-config.js"></script><script type="text/javascript" src="/js/klaro.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/polkadot-wiki/js/scrollSpy.js"></script><link rel="stylesheet" href="/polkadot-wiki/css/main.css"/><script src="/polkadot-wiki/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/polkadot-wiki/zh-CN"><img class="logo" src="/polkadot-wiki/img/favicon.ico" alt="Polkadot Wiki"/><h2 class="headerTitleWithLogo">Polkadot Wiki</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/polkadot-wiki/docs/zh-CN/build-index.html" target="_self">建立</a></li><li class="siteNavGroupActive"><a href="/polkadot-wiki/docs/zh-CN/learn-introduction.html" target="_self">学习</a></li><li class="siteNavGroupActive"><a href="/polkadot-wiki/docs/zh-CN/maintain-index.html" target="_self">参与 </a></li><li class=""><a href="https://wiki.polkadot.network/docs/en/kusama-index" target="_self">Kusama</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/polkadot-wiki/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/polkadot-wiki/docs/en/maintain-guides-how-to-setup-sentry-node.html">English</a></li><li><a href="/polkadot-wiki/docs/ru/maintain-guides-how-to-setup-sentry-node.html">Русский</a></li><li><a href="https://crowdin.com/project/polkadot-wiki" target="_blank" rel="noreferrer noopener">参与翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Validator</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">主要<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/index.html">维基索引</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/community.html">社区</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/contributing.html">贡献</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/glossary.html">专业术语</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/news.html">新闻</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/research.html">研究专页</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/grants.html">Grants</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/claims.html">认领</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">建立<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-index.html">开发者专页</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Development Guide</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-build-with-polkadot.html">Polkadot 開發者入门指南</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-dev-roadmap.html">开发路线图</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-pdk.html">平行链开发套件(PDKs)</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-cumulus.html">Cumulus</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-smart-contracts.html">智能合约</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-oracle.html">预言机</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-wallets.html">Polkadot Wallets</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Integration Guide</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-protocol-info.html">Polkadot 协议</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-node-management.html">节点管理</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-node-interaction.html">节点互动</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-transaction-construction.html">交易创建</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Tools</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-tools-index.html">工具索引</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Resources</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-examples-index.html">例子</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/build-hackathon.html">黑客马拉松</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">学习<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-introduction.html">Polkadot</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-launch.html">Polkadot 上线流程</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Basics</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-accounts.html">Polkadot 账户</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-architecture.html">Polkadot 架构</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-security.html">网络安全</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-consensus.html">Polkadot 共识机制</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-governance.html">治理</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-identity.html">身份</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-bridges.html">桥接</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-parachains.html">平行链</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-parathreads.html">平行线程</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-transaction-fees.html">交易费用</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-polkadot-host.html">Polkadot 主机 (PH)</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-treasury.html">财政库</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Advanced</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-staking.html">抵押</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-proxies.html">Proxy Accounts</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-availability.html">可用性和有效性</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-randomness.html">随机性</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-crosschain.html">跨链消息传递 (XCMP)</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-spree.html">SPREE</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-wasm.html">WebAssembly (Wasm)</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-phragmen.html">顺序弗拉格曼方法</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-simple-payouts.html">Simple Payouts</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Cryptography</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-cryptography.html">密码学讲解</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-keys.html">密匙</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Economics</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-DOT.html">DOT</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-auction.html">平行链插槽拍卖</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Polkadot Comparisons</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-comparisons-ethereum-2.html">以太坊 2.0</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-comparisons-cosmos.html">Cosmos</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-comparisons-dfinity.html">Dfinity</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-comparisons.html">与其它比较</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Miscellaneous</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-account-generation.html">创建帐户</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-roadmap.html">路线图</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-relevant-links.html">相关链接</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/learn-faq.html">常见问题</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">参与<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-index.html">网络维护者</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Collator</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-collator.html">收集人</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Nodes and Dapps</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-sync.html">设置全节点</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-networks.html">网络</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-wss.html">Set up Secure WebSocket for Remote Connections</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-errors.html">解决错误</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Nominator</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-nominator.html">提名人</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-nominate-polkadot.html">成为提名人 (Polkadot)</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-unbond.html">停止作为提名人</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Validator</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-validator.html">验证人</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-validate-polkadot.html">验证人指南</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-validator-payout.html">验证人付款概述</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-systemd.html">如何把节点设定为 `systemd` 进程运行</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-secure-validator.html">安全验证人节点</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-use-polkadot-secure-validator.html">如何使用 Polkadot 安全验证人设置</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-setup-sentry-node.html">设置哨兵节点</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-upgrade.html">如何升级验证人节点</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Governance Guides</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-democracy.html">参与民主权利</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-join-council.html">加入议会</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-vote-councillor.html">投票选举议员</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Kusama<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-index.html">主页</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Get Started</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-faucet.html">水龙头</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-claims.html">领取</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-endpoints.html">Kusama Endpoints</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">What to Try</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-maintain-guides-how-to-validate-kusama.html">验证人指南</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-maintain-guides-how-to-nominate-kusama.html">成为提名人 (Kusama)</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-learn-governance.html">治理</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-learn-identity.html">身份</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-learn-treasury.html">国库</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-build-build-with-polkadot.html">Polkadot 開發者入门指南</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/maintain-guides-society-kusama.html">Join Kappa Sigma Mu</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">What to Break</h4><ul><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/mirror-maintain-errors.html">解决错误</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-bug-bounty.html">漏洞奖励计画</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-adverserial-cheatsheet.html">Adverserial Cheatsheet</a></li></ul></div><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-timeline.html">时间线</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-community.html">社区</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-time-periods.html">参数</a></li><li class="navListItem"><a class="navItem" href="/polkadot-wiki/docs/zh-CN/kusama-coc.html">守则</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/polkadot-wiki/zh-CN" target="_blank" rel="noreferrer noopener">Translate</a><h1 id="__docusaurus" class="postHeaderTitle">设置哨兵节点</h1></header><article><div><span><p>本教程假设你已经设置好验证人并且想把你的节点提高女巫攻击或 DDOs 防御保护。这个跟 <a href="https://github.com/w3f/polkadot-secure-validator">polkadot secure validator</a> 配置一样。</p>
<p>我们会一步一步把验证人设置在 VPN 网络内。验证人只会与哨兵节点沟通并与网络分隔，从而减低你的验证人被入侵机会。</p>
<h2><a class="anchor" aria-hidden="true" id="vpn-安装--设置"></a><a href="#vpn-安装--设置" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>VPN 安装 &amp; 设置</h2>
<p>我们会使用 Wireguard 作为 VPN。 Wireguard 是快速和安全的 VPN ，它使用最新的密码学。如果你有兴趣想了解更多关于 Wireguard，前往<a href="https://www.wireguard.com/">这里</a>。在我们前往下一步之前，先设置防火墙并打开所需要的端口。</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># ssh port</span>
ufw allow 22/tcp
<span class="hljs-comment"># wireguard port</span>
ufw allow 51820/udp
<span class="hljs-comment"># libp2p port (注意: 只有哨兵节点需要)</span>
ufw allow 30333/tcp
ufw <span class="hljs-built_in">enable</span>
<span class="hljs-comment"># 再次检查防火墙规则</span>
ufw verbose
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="1-安装-wirguard"></a><a href="#1-安装-wirguard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 安装 Wirguard</h3>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># install linux headers</span>
apt install linux-headers-$(uname -r)
add-apt-repository ppa:wireguard/wireguard
apt-get update <span class="hljs-comment"># you can skip this on Ubuntu 18.04</span>
apt-get install wireguard
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="2-生成密钥"></a><a href="#2-生成密钥" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 生成密钥</h3>
<p>这里有二个指令当你设置 Wireguard 时会经常使用，<code>wg</code> 是设置程序用作管理 Wireguard 隧道接口，而 <code>wg-quick</code> 是用于启动或停止。</p>
<p>需要生成公钥/私钥对，请执行以下指令:</p>
<pre><code class="hljs css language-bash"><span class="hljs-built_in">cd</span> /etc/wireguard
<span class="hljs-built_in">umask</span> 077
wg genkey | sudo tee privatekey | wg pubkey | sudo tee publickey
</code></pre>
<p>你会看到 <code>publickey</code> 和 <code>privatekey</code> 已经创建了。从只看名称 <code>publickey</code> 包含了公钥而 <code>privatekey</code>包含了私钥对。</p>
<h3><a class="anchor" aria-hidden="true" id="3-设置"></a><a href="#3-设置" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 设置</h3>
<p>在 <code>/etc/wireguard/</code> 目录下创建 <code>wg0.conf</code> 文档，这将会用于设置其界面。</p>
<p>这是设置 <strong>验证人</strong> <code>wg0.conf</code> 的模版。</p>
<pre><code class="hljs css language-bash">[Interface]
<span class="hljs-comment"># specify the address you want to assign for this machine.</span>
Address = 10.0.0.1/32
<span class="hljs-comment"># the private key you just generated</span>
PrivateKey = 8MeWtQjBrmYazzwni7s/9Ow37U8eECAfAs0AIuffFng=
<span class="hljs-comment"># listening port of your server</span>
ListenPort = 51820
<span class="hljs-comment"># if you use wg to add a new peer when running, it will automatically</span>
<span class="hljs-comment"># save the newly added peers to your configuration file</span>
<span class="hljs-comment"># without requiring a restart</span>
SaveConfig = <span class="hljs-literal">true</span>

<span class="hljs-comment"># Public Node A</span>
[Peer]
<span class="hljs-comment"># replace it to the public node A public key</span>
PublicKey = Vdepw3JhRKDytCwjwA0nePLFiNsfB4KxGewl4YwAFRg=
<span class="hljs-comment"># public ip address for your public node machine</span>
Endpoint = 112.223.334.445:51820
<span class="hljs-comment"># replace it to the public node A interface address</span>
AllowedIPs = 10.0.0.2/32
<span class="hljs-comment"># keep the connection alive by sending a handshake every 21 seconds</span>
PersistentKeepalive = 21
</code></pre>
<blockquote>
<p>注意：在本指南中，我们仅设置了 1 个对等点(公开节点)</p>
</blockquote>
<p>您需要在您的  <strong>哨兵节点</strong> 中再次执行之前的步骤(1和2)，但 <code>wg0.onf</code>配置文件会是像这样：</p>
<pre><code class="hljs css language-bash">[Interface]
Address = 10.0.0.2/32
PrivateKey = eCii0j3IWi4w0hScc8myUj5QjXjjt5rp1VVuqlEmM24=
ListenPort = 51820
SaveConfig = <span class="hljs-literal">true</span>

<span class="hljs-comment"># Validator</span>
[Peer]
<span class="hljs-comment"># replace this with the validator public key</span>
PublicKey = iZeq+jm4baF3pTWR1K1YEyLPhrfpIckGjY/DfwCoKns=
<span class="hljs-comment"># public ip address of the validator</span>
Endpoint = 55.321.234.4:51820
<span class="hljs-comment"># replace it with the validator interface address</span>
AllowedIPs = 10.0.0.1/32
PersistentKeepalive = 21
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="4-测试连接"></a><a href="#4-测试连接" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 测试连接</h3>
<p>如果一切顺利，您已准备好测试连接。</p>
<p>要启动 VPN 隧道接口，请在您的 <code>验证人</code> 和 <code>哨兵节点</code> 中执行以下指令。</p>
<pre><code class="hljs css language-bash">wg-quick up wg0

<span class="hljs-comment"># The console would output something like this</span>
<span class="hljs-comment">#[#] ip link add wg0 type wireguard</span>
<span class="hljs-comment">#[#] wg setconf wg0 /dev/fd/63</span>
<span class="hljs-comment">#[#] ip -4 address add 10.0.0.1/24 dev wg0</span>
<span class="hljs-comment">#[#] ip link set mtu 1420 up dev wg0</span>
</code></pre>
<p>您可以通过运行 <code>wg</code> 来检查接口状态:</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Output</span>
 interface: wg0
  public key: iZeq+jm4baF3pTWR1K1YEyLPhrfpIckGjY/DfwCoKns=
  private key: (hidden)
  listening port: 51820

peer: Vdepw3JhRKDytCwjwA0nePLFiNsfB4KxGewl4YwAFRg=
  endpoint: 112.223.334.445:51820
  allowed ips: 10.0.0.2/32
  latest handshake: 18 seconds ago
  transfer: 580 B received, 460 B sent
  persistent keepalive: every 25 seconds
</code></pre>
<p>然后您可以使用 <code>ping</code> 来验证彼此之间的连接。</p>
<p>In case you want to update <code>wg0.conf</code>, run <code>wg-quick down wg0</code> to stop the interface first.</p>
<h3><a class="anchor" aria-hidden="true" id="5-configuring-your-sentry-node-and-validator"></a><a href="#5-configuring-your-sentry-node-and-validator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Configuring your Sentry Node and Validator</h3>
<p>当你启动了哨兵节点和验证人的 <code>wg0</code> 接口，用一点时间看一下你将会使用标志的描述。</p>
<p><code>--sentry &lt;VALIDATOR_MULTIADDR&gt;</code> - This would be required for your public node to be an authority as an observer. That means it acts the same as a validator node but without holding keys or signing. The difference between running a full node versus adding an extra <code>--sentry</code> flag is that a full node might not have all the data the validator needs to validate properly, while a sentry node will prioritize consensus messages to the validator. <code>--sentry</code> implies <code>--reserved-nodes</code>.</p>
<p><code>--sentry-nodes &lt;SENTRY_MULTIADDR&gt;</code> - This is required for your validator node to specify the sentry nodes to connect to. This flag will ensure that the isolated validator node can only be reached through it's sentry nodes. <code>--sentry-nodes</code> also implies <code>--reserved-nodes</code>.</p>
<p><code>--reserved-nodes</code> - The node will try to connect to these nodes and always accept connections from them, but it will still connect and accept connections from other nodes as well. This is useful if you want to have multiple validator nodes specify each other as peers.</p>
<p><code>--reserved-only</code> - Only allows the connection from reserved nodes you defined.</p>
<h4><a class="anchor" aria-hidden="true" id="p2p-networking"></a><a href="#p2p-networking" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>P2P Networking</h4>
<p>Nodes will use <a href="https://libp2p.io/">libp2p</a> as the networking layer to establish peers and gossip messages. In order to specify nodes as peers, you must do so using a <code>multiaddress</code> (<code>multiaddr</code>), which includes a node's <code>Peer Identity</code> (<code>PeerId</code>). A validator node will need to specify the <code>multiaddr</code> of it's sentry node(s), and a sentry node will specify the <code>multiaddr</code> of it's validator node(s).</p>
<h5><a class="anchor" aria-hidden="true" id="multiaddr"></a><a href="#multiaddr" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Multiaddr</h5>
<p><code>multiaddr</code> - A <code>multiaddr</code> is a flexible encoding of multiple layers of protocols into a human readable addressing scheme. For example, <code>/ip4/127.0.0.1/udp/1234</code> is a valid <code>multiaddr</code> that specifies you want to reach the 127.0.0.1 IPv4 loopback address with UDP packets on port 1234. Addresses in Substrate based chains will often take the form:</p>
<pre><code class="hljs"><span class="hljs-meta-keyword">/ip4/</span><span class="hljs-params">&lt;IP ADDRESS&gt;</span><span class="hljs-meta-keyword">/tcp/</span><span class="hljs-params">&lt;P2P PORT&gt;</span><span class="hljs-meta-keyword">/p2p/</span><span class="hljs-params">&lt;PEER IDENTITY&gt;</span>
</code></pre>
<ul>
<li><p><code>IP_ADDRESS</code> - Unless the node is public, this will often be the ip address of the node within the private network.</p></li>
<li><p><code>P2P_PORT</code> - This is the port that nodes will send p2p messages over. By default, this will be 30333, but can be explicitly specified using the <code>--port &lt;P2P_PORT&gt;</code> cli flag.</p></li>
<li><p><code>PEER IDENTITY</code> - The PeerId is a unique identifier for each peer.</p></li>
</ul>
<h5><a class="anchor" aria-hidden="true" id="peerid"></a><a href="#peerid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PeerId</h5>
<p>Each peer in the network will have a private (secret) key (not to be confused with account keys or session keys) that will be used for network messaging. The secret key will have a corresponding public key, as well as a public address (<code>PeerId</code>) derived from this private key. <code>PeerId</code>' is derived from the secret key that is stored in the following directory by default:</p>
<pre><code class="hljs"><span class="hljs-meta-keyword">/home/</span>$USER/.local<span class="hljs-meta-keyword">/share/</span>polkadot<span class="hljs-meta-keyword">/chains/</span><span class="hljs-params">&lt;CHAIN&gt;</span><span class="hljs-meta-keyword">/network/</span>secret_ed25519
</code></pre>
<p>Where <code>&lt;CHAIN&gt;</code> will be either <code>polkadot</code> for Polkadot, <code>ksmcc3</code> for Kusama, or <code>westend2</code> for Westend.</p>
<p>If the <code>secret_ed25519</code> file does not exist by the time the node is running (or is not otherwise specified), a new <code>secret_ed25519</code> will be created and used to derive a new <code>PeerId</code>.</p>
<p>If you want to explicitly specify the secret key to use, you can do so with the <code>--node-key-file &lt;KEY_FILE&gt;</code> flag, where <code>KEY_FILE</code> is the path of a file containing an unencoded 32 byte Ed25519 secret key, or the <code>--node-key &lt;KEY&gt;</code> flag, where <code>KEY</code> is a hex-encoded 32 byte secret key. If explicitly specifying a secret key, it is recommended to specify it as a file.</p>
<blockquote>
<p>Note: It is useful to generate or back up the <code>secret_ed25519</code> files if you want to use static addresses for sentry configurations. Otherwise you may have to dynamically find and set the <code>PeerId</code>.</p>
</blockquote>
<p>You can use <a href="https://github.com/paritytech/substrate/tree/master/bin/utils/subkey">subkey</a> to generate a new <code>secret_ed25519</code> as follows:</p>
<pre><code class="hljs css language-bash">&gt; subkey generate-node-key &lt;/PATH/SECRET_ED25519_FILE&gt;
<span class="hljs-comment"># Output</span>
12D3KooWSAhdYsqrJKed3r5HKTJzpEWFUXCFmn6wv85M2woLLJpD
</code></pre>
<p>Running this will return the corresponding <code>PeerId</code> for the <code>secret_ed25519</code>.</p>
<blockquote>
<p>Note: You may see two different kinds of representations of <code>PeerId</code>s, one that looks like <code>12D3KooWSAhdYsqrJKed3r5HKTJzpEWFUXCFmn6wv85M2woLLJpD</code>, and one that looks like <code>QmdtiSGnqDoHrfVyxrRWuETyehMnmZJhxrnVBFyYtY7Trk</code>. These are two different representations of the same <code>secret_ed25519</code> key and will both work, however <code>Qm...</code> is the legacy representation. It is recommended to use the updated representation (<code>1D3KooW...</code>), otherwise warnings may be shown in the logs.</p>
</blockquote>
<h5><a class="anchor" aria-hidden="true" id="retrieving-peerids"></a><a href="#retrieving-peerids" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Retrieving <code>PeerId</code>'s</h5>
<p>There are a couple of way to find out the <code>PeerId</code>. of the validator and sentry nodes.</p>
<p>You can use <code>subkey</code> to print out the corresponding <code>PeerId</code> using:</p>
<pre><code class="hljs css language-bash">subkey inspect-node-key &lt;/PATH/SECRET_ED25519_FILE&gt;
<span class="hljs-comment"># Output</span>
12D3KooWSAhdYsqrJKed3r5HKTJzpEWFUXCFmn6wv85M2woLLJpD
</code></pre>
<p>Another way is by starting the node to see the identity printed as follows:</p>
<p><code>./polkadot --validator</code></p>
<pre><code class="hljs"><span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> Parity Polkadot
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> ✌️  version <span class="hljs-number">0.8</span><span class="hljs-number">.8</span>-b2c9c149-x86_64-linux-gnu
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> ❤️  by Parity Technologies &lt;<span class="hljs-symbol">admin@</span>parity.io&gt;, <span class="hljs-number">2017</span><span class="hljs-number">-2020</span>
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 📋 Chain specification: Polkadot CC1
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 🏷  Node name: validator-node
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 👤 Role: AUTHORITY
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 💾 Database: RocksDb at /home/$USER/.local/share/polkadot/chains/polkadot/db
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> ⛓  Native runtime: polkadot<span class="hljs-number">-8</span> (parity-polkadot<span class="hljs-number">-0.</span>tx0.au0)
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 📦 Highest known block at #<span class="hljs-number">529</span>
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 🏷  Local node identity <span class="hljs-keyword">is</span>: <span class="hljs-number">12</span>D3KooWSAhdYsqrJKed3r5HKTJzpEWFUXCFmn6wv85M2woLLJpD (legacy representation: QmdtiSGnqDoHrfVyxrRWuETyehMnmZJhxrnVBFyYtY7Trk)
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 〽️ Prometheus server started at <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">9615</span>
<span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">42</span>:<span class="hljs-number">21</span> 👶 Starting BABE Authorship worker
</code></pre>
<p>Here we can see our <code>PeerId</code> is <code>12D3KooWSAhdYsqrJKed3r5HKTJzpEWFUXCFmn6wv85M2woLLJpD</code>.</p>
<p>Lastly, we can also find the <code>PeerId</code> by calling the following RPC call from the same host:</p>
<pre><code class="hljs css language-bash">curl -H <span class="hljs-string">"Content-Type: application/json"</span> -d <span class="hljs-string">'{"id":1, "jsonrpc":"2.0", "method": "system_localPeerId", "params":[]}'</span> http://localhost:9933
<span class="hljs-comment"># Output</span>
{<span class="hljs-string">"jsonrpc"</span>:<span class="hljs-string">"2.0"</span>,<span class="hljs-string">"result"</span>:<span class="hljs-string">"12D3KooWSAhdYsqrJKed3r5HKTJzpEWFUXCFmn6wv85M2woLLJpD"</span>,<span class="hljs-string">"id"</span>:1}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="setting-validator-and-sentry-peers"></a><a href="#setting-validator-and-sentry-peers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting Validator and Sentry Peers</h4>
<p>After retrieving the appropriate <code>PeerId</code> of both the sentry and validator nodes, we can set them using the following flags:</p>
<p>Start your sentry with <code>--sentry</code> flag:</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Sentry Node</span>
polkadot \
--name <span class="hljs-string">"Sentry-A"</span> \
--sentry /ip4/VALIDATOR_VPN_ADDRESS/tcp/30333/p2p/VALIDATOR_NODE_PEER_ID
</code></pre>
<p>Start the validator with the <code>--valdiator</code> and <code>--sentry-nodes</code> flags:</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Validator Node</span>
polkadot \
--name <span class="hljs-string">"Validator"</span> \
--reserved-only \
--sentry-nodes /ip4/SENTRY_VPN_ADDRESS/tcp/30333/p2p/SENTRY_NODE_PEER_ID \
--validator
</code></pre>
<p>You should see your validator has 1 peer, that is a connection from your sentry node. Do the above steps to spin up few more if you think one sentry node is not enough.</p>
<pre><code class="hljs"><span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">42</span>:<span class="hljs-number">57</span> 💤 Idle (<span class="hljs-number">1</span> peers), best: #<span class="hljs-number">1913174</span> (<span class="hljs-number">0x24f6</span>…<span class="hljs-number">14f</span>9), finalized #<span class="hljs-number">1913151</span> (<span class="hljs-number">0xced8</span>…<span class="hljs-number">492</span>b), ⬇ <span class="hljs-number">18.0</span>kiB/s ⬆ <span class="hljs-number">4.5</span>kiB/s
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">42</span>:<span class="hljs-number">58</span> 🔍 Discovered new <span class="hljs-keyword">external</span> address <span class="hljs-keyword">for</span> our node: /ip4/<span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.164</span>/tcp/<span class="hljs-number">30333</span>/p2p/<span class="hljs-number">12</span>D3KooWEnA6JqCk59k8SNShYDGDHTfdqGJLsTpZjgLRT6rAqfDg
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">00</span> ✨ Imported #<span class="hljs-number">1913175</span> (<span class="hljs-number">0x76c0</span>…ad3e)
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">00</span> Starting parachain attestation session on top of parent <span class="hljs-number">0x76c0c4649d290c840523316ac157380dd703fa1b9fb83b326756ce35ff49ad3e</span>. Local parachain duty <span class="hljs-keyword">is</span> None
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">02</span> 💤 Idle (<span class="hljs-number">1</span> peers), best: #<span class="hljs-number">1913175</span> (<span class="hljs-number">0x76c0</span>…ad3e), finalized #<span class="hljs-number">1913172</span> (<span class="hljs-number">0x5925</span>…<span class="hljs-number">15</span>bd), ⬇ <span class="hljs-number">33.0</span>kiB/s ⬆ <span class="hljs-number">7.1</span>kiB/s
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">07</span> ✨ Imported #<span class="hljs-number">1913176</span> (<span class="hljs-number">0xf1bc</span>…<span class="hljs-number">3</span>ace)
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">07</span> Starting parachain attestation session on top of parent <span class="hljs-number">0xf1bc3c7ed57070b4ad48bfc564a16827dc7486582f97abf00ff38061e4ef3ace</span>. Local parachain duty <span class="hljs-keyword">is</span> None
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">07</span> 💤 Idle (<span class="hljs-number">1</span> peers), best: #<span class="hljs-number">1913176</span> (<span class="hljs-number">0xf1bc</span>…<span class="hljs-number">3</span>ace), finalized #<span class="hljs-number">1913173</span> (<span class="hljs-number">0x4c97</span>…e6b6), ⬇ <span class="hljs-number">16.4</span>kiB/s ⬆ <span class="hljs-number">5.9</span>kiB/s
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">08</span> ✨ Imported #<span class="hljs-number">1913176</span> (<span class="hljs-number">0x672e</span>…<span class="hljs-number">6123</span>)
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">12</span> 💤 Idle (<span class="hljs-number">1</span> peers), best: #<span class="hljs-number">1913176</span> (<span class="hljs-number">0xf1bc</span>…<span class="hljs-number">3</span>ace), finalized #<span class="hljs-number">1913174</span> (<span class="hljs-number">0x24f6</span>…<span class="hljs-number">14f</span>9), ⬇ <span class="hljs-number">43.7</span>kiB/s ⬆ <span class="hljs-number">29.4</span>kiB/s
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">13</span> ✨ Imported #<span class="hljs-number">1913177</span> (<span class="hljs-number">0x4e1b</span>…<span class="hljs-number">209f</span>)
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">13</span> Starting parachain attestation session on top of parent <span class="hljs-number">0x4e1b8fd258739d5784fbdf7cf156e2ebfd90159b21427b8e041a3aa73b99209f</span>. Local parachain duty <span class="hljs-keyword">is</span> None
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">14</span> ✨ Imported #<span class="hljs-number">1913177</span> (<span class="hljs-number">0x9b77</span>…<span class="hljs-number">67</span>c7)
<span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-16</span> <span class="hljs-number">19</span>:<span class="hljs-number">43</span>:<span class="hljs-number">17</span> 💤 Idle (<span class="hljs-number">1</span> peers), best: #<span class="hljs-number">1913177</span> (<span class="hljs-number">0x4e1b</span>…<span class="hljs-number">209f</span>), finalized #<span class="hljs-number">1913174</span> (<span class="hljs-number">0x24f6</span>…<span class="hljs-number">14f</span>9)
</code></pre>
<blockquote>
<p>Note: You may have to start the sentry node first in order for the validator node to recognize it as a peer. If it does not show up as a peer, try resrtarting the validator node after the sentry is already running.</p>
</blockquote>
<p>Congratulations! You have successfully set up a validator with a public facing node and now have a more secure way of running your validator.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 6/15/2020 by w3fbot</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-use-polkadot-secure-validator.html"><span class="arrow-prev">← </span><span>如何使用 Polkadot 安全验证人设置</span></a><a class="docs-next button" href="/polkadot-wiki/docs/zh-CN/maintain-guides-how-to-upgrade.html"><span>如何升级验证人节点</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#vpn-安装--设置">VPN 安装 &amp; 设置</a><ul class="toc-headings"><li><a href="#1-安装-wirguard">1. 安装 Wirguard</a></li><li><a href="#2-生成密钥">2. 生成密钥</a></li><li><a href="#3-设置">3. 设置</a></li><li><a href="#4-测试连接">4. 测试连接</a></li><li><a href="#5-configuring-your-sentry-node-and-validator">5. Configuring your Sentry Node and Validator</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/polkadot-wiki/" class="nav-home"><img src="/polkadot-wiki/img/favicon.ico" alt="Polkadot Wiki" width="66" height="58"/></a><div><a href="https://stackoverflow.com/questions/tagged/polkadot" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://riot.w3f.tech/#/room/#polkadot-watercooler:matrix.org">Polkadot Watercooler (Riot Chat)</a><a href="https://twitter.com/polkadotnetwork" target="_blank" rel="noreferrer noopener">Twitter</a></div><a class="github-button" href="https://github.com/paritytech/polkadot" data-icon="octicon-star" data-count-href="/paritytech/polkadot/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></section><section class="row"><div class="copyright">Copyright © 2020 Web3 Foundation</div><a class="item" href="https://polkadot.network/privacy/">Privacy Policy</a><a class="item" href="#" id="cookie-settings">Cookie Settings</a><script>
              var cookieSettings = document.getElementById('cookie-settings');
              cookieSettings.onclick = function() {
                return klaro.show();
              };
              </script></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '8bfa06b56bb8f33e5698c7f40b00b38f',
                indexName: 'polkadot',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-CN"]}
              });
            </script></body></html>